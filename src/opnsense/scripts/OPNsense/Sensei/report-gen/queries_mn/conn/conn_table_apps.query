db.conn_all.aggregate([{"$match":{"start_time":{"$gt":___START_TIME___,"$lt": ___END_TIME___}, "src_dir":"EGRESS"}},{"$group":{"_id": {"app_name":"$app_name"},"total_src_nbytes":{"$sum":"$src_nbytes"},"total_dst_nbytes":{"$sum":"$dst_nbytes"},"total_src_npackets":{"$sum":"$src_npackets"},"total_dst_npackets":{"$sum":"$dst_npackets"},"ip_src_saddr":{"$addToSet":"$ip_src_saddr"},"ip_dst_saddr":{"$addToSet":"$ip_dst_saddr"},"total":{"$sum":1}}},{"$sort":{"total": -1}},{"$limit":50}])