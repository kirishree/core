[ { "$match": { "start_time": { "$gt":__GTE__, "$lt": __LTE__ } } }, { "$project": { "ip_dst_saddr": "$ip_dst_saddr", "start_time": "$start_time", "_interval": { "$floor": { "$divide": [ { "$toLong": "$start_time" }, __INTERVAL__ ] } } } }, { "$group": { "_id": { "_interval": "$_interval" }, "start_time": { "$max": "$start_time" }, "label": { "$addToSet": "$ip_dst_saddr" }, "total": { "$sum": 1 } } }, { "$sort": { "start_time": 1 } }, { "$limit": 10 } ]