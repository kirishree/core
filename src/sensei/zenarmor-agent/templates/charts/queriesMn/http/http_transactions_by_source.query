[ { "$match": { "start_time": { "$gt":__GTE__, "$lt": __LTE__ } } }, { "$project": { "label": "$src_hostname","start_time":"$start_time", "_interval": { "$floor": { "$divide": [ { "$toLong": "$start_time" }, __INTERVAL__ ] } } } }, { "$group": { "_id": { "label": "$label", "_interval": "$_interval" },"start_time": {"$max":"$start_time"}, "total":{"$sum":"___SUM_FIELD___"}}},{"$sort":{"total":-1}},{"$limit":10}]